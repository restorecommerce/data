---
  id: fallback-deny-all
  name: Fallback Deny All
  description: Fallback to Deny all
  effect: DENY
  target:
    subjects: [ ]
    actions: [ ]
    resources: [ ]
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: fallback-permit-all
  name: Fallback Permits All
  description: Fallback to Permits all
  effect: PERMIT
  target:
    subjects: [ ]
    actions: [ ]
    resources: [ ]
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: superadministrator-permits-all
  name: SuperAdmin Permits All Rule
  description: Permits all if subject is SuperAdmin
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: superadministrator-r-id
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: administrator-permits-all-hr-scoped
  name: Admin Permits All Rule HR Scoped
  description: Permits all if subject is Admin within hierarchical scope
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: administrator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: administrator-permits-read-scoped
  name: Admin Permits Read Rule HR Scoped
  description: Permits read if subject is Admin within hierarchical scope
  target:
    resources: [ ]
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: administrator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: sales-permits-all-hr-scoped
  name: Sales Permits All HR Scoped
  description: Permits all if subject is Sales within hierarchical scope
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: sales-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: sales-permits-read-hr-scoped
  name: Sales Permits Read HR Scope
  description: Permits read if subject is Sales within hierarchical scope
  target:
    resources: [ ]
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: sales-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: moderator-permits-all-hr-scoped
  name: Moderator Permits All HR Scoped
  description: Permits all if subject is Moderator within hierarchical scope
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: moderator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: moderator-permits-read-hr-scoped
  name: Moderator Permits Read HR Scoped
  description: Permits read if subject is Moderator within hierarchical scope
  target:
    resources: [ ]
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: moderator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: moderator-permits-create-hr-scoped
  name: Moderator Permits Create HR Scoped
  description: Permits create if subject is Moderator within hierarchical scope
  target:
    resources: [ ]
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: moderator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:create
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: moderator-permits-update-hr-scoped
  name: Moderator Permits Update HR Scoped
  description: Permits update if subject is Moderator within hierarchical scope
  target:
    resources: [ ]
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: moderator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:update
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: member-permits-read-hr-scoped
  name: Member Permits Read Rule
  description: Permits read if subject is Member within hierarchical scope
  target:
    resources: [ ]
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: member-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: customer-permits-read-hr-scoped
  name: Customer Permits Read HR Scope
  description: Permits read if subject is Customer within hierarchical scope
  target:
    resources: [ ]
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: customer-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: user-permits-all-owned
  name: User Permits All Owned
  description: Permits all if resource is owned by subject
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: user-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:user.User
      - id: urn:restorecommerce:acs:names:hierarchicalRoleScoping
        value: "false"
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition: "
    !context?.resources?.some(
      resource => resource?.user_id !== context.subject?.id
        || resource?.private?.user_id !== context.subject?.id
    )
  "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: user-permits-create-owned
  name: User Permits Create Owned
  description: Permits create if resource is owned by subject
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: user-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:user.User
      - id: urn:restorecommerce:acs:names:hierarchicalRoleScoping
        value: "false"
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:create
    resources: [ ]
  effect: PERMIT
  condition: "
    !context?.resources?.some(
      resource => resource?.user_id !== context.subject?.id
        || resource?.private?.user_id !== context.subject?.id
    )
  "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: user-permits-update-owned
  name: User Permits Update Owned
  description: Permits update if resource is owned by subject
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: user-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:user.User
      - id: urn:restorecommerce:acs:names:hierarchicalRoleScoping
        value: "false"
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:update
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: user-permits-read-owned
  name: User Permits Read Owned
  description: Permits read if resource is owned by subject User
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: user-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:user.User
      - id: urn:restorecommerce:acs:names:hierarchicalRoleScoping
        value: "false"
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: user-permits-update-user-owned
  name: User Permits Update User Owned
  description: Permits updated for owned user
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: user-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:user.User
      - id: urn:restorecommerce:acs:names:hierarchicalRoleScoping
        value: "false"
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:update
    resources:
      - id: urn:restorecommerce:acs:names:model:entity
        value: urn:restorecommerce:acs:model:user.User
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#name
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#first_name
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#last_name
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#default_scope
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#locale_id
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#timezone_id
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#tokens
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: permit-read-strict-scoped
  name: Scoped User Permits Read
  description: Permits read if resource is owned by scope
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: scoped-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:hierarchicalRoleScoping
        value: "false"
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: unauthenticated-user-permits-create-strict-scope
  name: Unauthenticated Create Strict Scope
  description: Permits create if subject is Unauthenticated User within strict scope
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: unauthenticated-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:hierarchicalRoleScoping
        value: "false"
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:create
    resources: [ ]
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: domainless-unauthenticated-permits-read-system
  name: Domainless Unauthenticated Permits Read System
  description: Permits read system for unauthenticated users without domain
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:unauthenticated-user
        value: "true"
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
    resources: [ ]
  effect: PERMIT
  condition: "{ filters: [ { field: 'meta.owners[*].attributes[0].value', operation: 'in', value: 'system' } ] }"
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: everyone-permits-reset-password
  name: Everyone Permits Reset Password
  description: Permits reset password to everyone
  target:
    subjects: [ ]
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:update
    resources:
      - id: urn:restorecommerce:acs:names:model:entity
        value: urn:restorecommerce:acs:model:user.User
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#activation_code
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#password_hash
      - id: urn:restorecommerce:acs:names:model:property
        value: urn:restorecommerce:acs:model:user.User#email
  effect: PERMIT
  condition: ""
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: sales-requires-order-state-submitted
  name: Sales Requires Order State Submitted
  description: Permits if order state is Submitted for subject Sales
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: sales-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        resource.order_state?.toString() === 'SUBMITTED'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: sales-requires-order-state-withdrawn
  name: Sales Requires Order State Withdrawn
  description: Permits if order state is Withdrawn for subject Sales
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: sales-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        resource.order_state?.toString() === 'WITHDRAWN'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: sales-requires-order-state-canceled
  name: Sales Requires Order State Canceled
  description: Permits if order state is Canceled for subject Sales
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: sales-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        resource.order_state?.toString() === 'CANCELED'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: moderator-requires-order-state-submitted
  name: Moderator Requires Order State Submitted
  description: Permits if order state is Submitted for subject Moderator
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: moderator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        resource.order_state?.toString() === 'SUBMITTED'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: moderator-requires-order-state-withdrawn
  name: Moderator Requires Order State Withdrawn
  description: Permits if order state is Withdrawn for subject Moderator
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: moderator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        resource.order_state?.toString() === 'WITHDRAWN'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: moderator-requires-order-state-canceled
  name: Moderator Requires Order State Canceled
  description: Permits if order state is Canceled for subject Moderator
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: moderator-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        resource.order_state?.toString() === 'CANCELED'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: user-requires-order-state-created
  name: User Requires Order State Created
  description: Permits if order state is Created for subject User
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: user-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        !resource.order_state
        || resource.order_state?.toString() === 'CREATED'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: customer-requires-order-state-created
  name: Customer Requires Order State Created
  description: Permits if order state is Created for subject Customer
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: customer-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        !resource.order_state
        || resource.order_state?.toString() === 'CREATED'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: customer-requires-order-state-submitted
  name: Customer Requires Order State Submitted
  description: Permits if order state is Submitted for subject Customer
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: customer-r-id
      - id: urn:restorecommerce:acs:names:roleScopingEntity
        value: urn:restorecommerce:acs:model:organization.Organization
    actions: [ ]
    resources: [ ]
  effect: PERMIT
  condition:
    "
    context?.resources?.some(
      resource => (
        !resource.order_state
        || resource.order_state?.toString() === 'SUBMITTED'
      )
    )
    "
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: normal-user-read-roles
  name: Normal User Role read rule
  description: Normal User should be allowed to read all Roles in system
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: user-r-id
    resources:
      - id: urn:restorecommerce:acs:names:model:entity
        value: urn:restorecommerce:acs:model:role.Role
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
  effect: PERMIT
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system
---
  id: admin-user-read-roles
  name: Admin User Role read rule
  description: Admin User should be allowed to read all Roles in system
  target:
    subjects:
      - id: urn:restorecommerce:acs:names:role
        value: administrator-r-id
    resources:
      - id: urn:restorecommerce:acs:names:model:entity
        value: urn:restorecommerce:acs:model:role.Role
    actions:
      - id: urn:oasis:names:tc:xacml:1.0:action:action-id
        value: urn:restorecommerce:acs:names:action:read
  effect: PERMIT
  evaluationCacheable: false
  meta:
    modifiedBy: ""
    owners:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
        attributes:
          - id: urn:restorecommerce:acs:names:ownerInstance
            value: system