rules:
  - id: fbff989edf064ae680ccd9df7c946f3f
    name: Fallback rule
    effect: DENY
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
  - id: aabfb8ed51064baaa3eafe43d3d4c44e
    name: User read rule
    description: Permits any read if the resource is under an organizational hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:user.User
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: d892b81c25064a848f0dafb55093bbdf
    name: Organization read rule
    description: Permits any read if the resource is under an organizational hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:organization.Organization
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: bbc1f8622b1049d9b54a66237d4fd651
    name: Address read rule
    description: Permits any read if the resource is under an organizational hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:address.Address
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 4509c76b54c44d0584b2a652a789e44e
    name: ContactPoint read rule
    description: Permits any read if the resource is under an organizational hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:contact_point.ContactPoint
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 402e831240284451968457d2549d9ffb
    name: ContactPointType read rule
    description: Permits read for all users in any Organization
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:contact_point_type.ContactPointType
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 19eefaa16fff42bf881c16eca946b029
    name: Locale read rule
    description: Permits read for all users in any Organization
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:locale.Locale
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 94140965831f46deb1eebf9ab36c4572
    name: Timezone read rule
    description: Permits read for all users
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:timezone.Timezone
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 43cd9e2b462a426ca30d2a1bcb1e54c8
    name: Role read rule
    description: Only Admin should be allowed to read all Roles in system
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:role
          value: dfcfe667eb614cc1864b3c723297240a # Admin
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:role.Role
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: a0325bfbbdd84dd59274b09ca0c7e239
    name: Role SuperAdmin read rule
    description: SuperAdmin role should not be readable
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:role.Role
        - id: urn:oasis:names:tc:xacml:1.0:resource:resource-id
          value: 78c2571c1bf8483285ca61633a24a451
    effect: DENY
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: f7ae06e4d33b4340b351945ed6339143
    name: Tax read rule
    description: Permits read for all users in any Organization
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:tax.Tax
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 72a509eeaf8e4f5ba999116c6c797f0b
    name: TaxType read rule
    description: Permits read for all users in any Organization
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:tax_type.TaxType
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 0293e152015c41fb923e17c0589fe7d2
    name: Country read rule
    description: Permits read for all users in any Organization
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:country.Country
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 8f5fb142972e44ffbb136ca3770212da
    name: Register User rule
    description: Targets register
    target:
      subject:
        - id: urn:restorecommerce:acs:names:unauthenticated-user
          value: "true"
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:create
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:user.User
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 27a50edd71d942e3b2812a30f1879acb
    name: User 'Forgot Password' rule
    description: Permits 'modify'  by unauthenticated users on their password
    target:
      subject:
        - id: urn:restorecommerce:acs:names:unauthenticated-user
          value: "true"
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:modify
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:user.User
        - id: urn:restorecommerce:acs:names:model:property
          value: urn:restorecommerce:acs:model:user.User#activation_code
        - id: urn:restorecommerce:acs:names:model:property
          value: urn:restorecommerce:acs:model:user.User#password_hash
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 50e5c475987c4a83bb1acd9ff84af090
    name: User 'ConfirmEmailChange' rule
    description: Permits 'modify'  by unauthenticated users on their password
    target:
      subject:
        - id: urn:restorecommerce:acs:names:unauthenticated-user
          value: "true"
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:modify
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:user.User
        - id: urn:restorecommerce:acs:names:model:property
          value: urn:restorecommerce:acs:model:user.User#activation_code
        - id: urn:restorecommerce:acs:names:model:property
          value: urn:restorecommerce:acs:model:user.User#email
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: eeefbe2065c74c9d8ae7fa3e3ce7992e
    name: User Activation
    description: Permits 'modify' by unauthenticated users in case of activation
    target:
      subject:
        - id: urn:restorecommerce:acs:names:unauthenticated-user
          value: "true"
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:modify
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:user.User
        - id: urn:restorecommerce:acs:names:model:property
          value: urn:restorecommerce:acs:model:user.User#active
        - id: urn:restorecommerce:acs:names:model:property
          value: urn:restorecommerce:acs:model:user.User#activation_code
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: cc6e90accbb8453699fa658e1bc2f6c9
    name: User Account Rule
    description: Permits actions by any User on its own account data
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # Normal User
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:user.User
    condition: # if it's the User's own account const { target, context } = request; # context.resources[0].instance.id
      "
        const resources = target.resources;

        let isUser = false;
        let match = false;
        for (let attribute of resources) {
          if (attribute.id == 'urn:restorecommerce:acs:names:model:entity') {
            isUser = (attribute.value == 'urn:restorecommerce:acs:model:user.User');
          } else if (attribute.id == 'urn:oasis:names:tc:xacml:1.0:resource:resource-id') {
            if (attribute.value == context.subject.id && isUser)
              match = true;
              isUser = false;
            } else {
              match = false;
              break;
            }
          }
        match;
      "
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 2cda35a30992415b89066e06c09d9d4d
    name: User Admin Rule
    description: Permits if subject is Admin within the resource's hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: dfcfe667eb614cc1864b3c723297240a # Admin
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:user.User
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 4f039ce5635e4cf0bb422dcd68f732c9
    name: Organization Admin Rule
    description: Permits if subject is Admin within the resource's hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: dfcfe667eb614cc1864b3c723297240a # Admin
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:organization.Organization
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 7d9561f3d6cb4a03bdcc56f75dc2776a
    name: Address Admin Rule
    description: Permits if subject is Admin within the resource's hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: dfcfe667eb614cc1864b3c723297240a # Admin
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:address.Address
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: b59a29b5b01e40d1ae5bb44240d906f7
    name: ContactPoint Admin Rule
    description: Permits if subject is Admin within the resource's hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: dfcfe667eb614cc1864b3c723297240a # Admin
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:contact_point.ContactPoint
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  # Special Rules
  - id: aa78cbecdbac4b53a914f5836b744c2d
    name: DeleteOrg Rule
    description: Rule targeting the `DeleteOrgData` mutation
    target:
      resources:
        - id: urn:restorecommerce:acs:names:operation
          value: mutation.deleteOrgData
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:execute
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 78c2571c1bf8483285ca61633a24a451 # SuperAdmin
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 2769c1a7e09f4971ad04fcca39094c2fx
    name: ExecuteCommand Rule
    description: Targets the `ExecuteCommand` mutation
    target:
      resources:
        - id: urn:restorecommerce:acs:names:operation
          value: mutation.executeCommand
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:execute
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 78c2571c1bf8483285ca61633a24a451 # SuperAdmin
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: ff7da3d8aaca4b2cb66d324d4ff6f71d
    name: SuperAdmins Rule
    description: Permit anything by SuperAdmins (fallback rule)
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 78c2571c1bf8483285ca61633a24a451 # SuperAdmin
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 123d2f19370447ac82708c8a196bd3a9
    name: Order create read or modify rule
    description: Permits Order create, read or modify under an organizational hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:order.Order
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 7ccec95b94a04e08951e331fef59a9ee
    name: Order create read or modify rule
    description: Permits Order create, read or modify under an user hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:user.User
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:order.Order
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 033ac24c43664c5c92fd32b21b92dba9
    name: Customer read rule for Organizational Scope
    description: Permits any read if the resource is under an organizational hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:customer.Customer
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: f22c7ec8c97b4dd385364219559b07e1
    name: Customer read rule for Independent User Scope
    description: Permits any read if the resource is under an user hierarchical scope
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:user.User
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:customer.Customer
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  ## Product, Manufacturer, ProductPrototype, ProductCategory, PriceGroup - Master Data
  - id: 5b78e4a1cc034ddb8d71d46dfd9a53f7
    name: Product read rule
    description: Permits read for all users in any Organization or Independent user
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:product.Product
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: f58d4fc3da244023a191c015b2b82786
    name: Manufacturer read rule
    description: Permits read for all users in any Organization or Independent user
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:manufacturer.Manufacturer
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 4840a726a1d44ee78d207fa5cc85c024
    name: ProductPrototype read rule
    description: Permits read for all users in any Organization or Independent user
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:product_prototype.ProductPrototype
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: cafb58f0676c460f9034a697cd74b9df
    name: ProductCategory read rule
    description: Permits read for all users in any Organization or Independent user
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:product_category.ProductCategory
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
  - id: 5eb184be7cc145c9b4b0e230d74f1937
    name: PriceGroup read rule
    description: Permits read for all users in any Organization or Independent user
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # NormalUser
      action:
        - id: urn:oasis:names:tc:xacml:1.0:action:action-id
          value: urn:restorecommerce:acs:names:action:read
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:price_group.PriceGroup
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
#ostorage rules -> Xingular
  - id: 78f58e364c984b5f9945d993b64dd405
    name: Object Storage rule
    description: Allows normal user to perform CRUD on Object storage data on his organization
    target:
      subject:
        - id: urn:restorecommerce:acs:names:role
          value: 95a9302f65434061a3f33e9197c7af24 # Normal User
        - id: urn:restorecommerce:acs:names:roleScopingEntity
          value: urn:restorecommerce:acs:model:organization.Organization
      resources:
        - id: urn:restorecommerce:acs:names:model:entity
          value: urn:restorecommerce:acs:model:ostorage.Ostorage
    effect: PERMIT
    owner:
      - id: urn:restorecommerce:acs:names:ownerIndicatoryEntity
        value: urn:restorecommerce:acs:model:organization.Organization
      - id: urn:restorecommerce:acs:names:ownerInstance
        value: ce79782cbd064389aaf66d280d3a6c06
